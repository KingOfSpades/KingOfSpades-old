<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="Scaling applications - Rollout, Scale and Auto-Scale Deployments" /><meta property="og:locale" content="en" /><meta name="description" content="This post is gonna be a bit bigger broader then what is requested on the EX280 exam objectives. In this post we will have a look at: Controlling roll-out of pods (manually rolling out or back a deployment) Scaling Deployments on the command-line Creating a auto scaler for a deployment on the command-line" /><meta property="og:description" content="This post is gonna be a bit bigger broader then what is requested on the EX280 exam objectives. In this post we will have a look at: Controlling roll-out of pods (manually rolling out or back a deployment) Scaling Deployments on the command-line Creating a auto scaler for a deployment on the command-line" /><link rel="canonical" href="https://kingofspades.github.io/posts/controlling-pod-rollout-and-scaling/" /><meta property="og:url" content="https://kingofspades.github.io/posts/controlling-pod-rollout-and-scaling/" /><meta property="og:site_name" content="Christian’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-23T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Scaling applications - Rollout, Scale and Auto-Scale Deployments" /><meta name="twitter:site" content="@CABenstein" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-01-23T22:16:58+01:00","datePublished":"2022-01-23T00:00:00+01:00","description":"This post is gonna be a bit bigger broader then what is requested on the EX280 exam objectives. In this post we will have a look at: Controlling roll-out of pods (manually rolling out or back a deployment) Scaling Deployments on the command-line Creating a auto scaler for a deployment on the command-line","headline":"Scaling applications - Rollout, Scale and Auto-Scale Deployments","mainEntityOfPage":{"@type":"WebPage","@id":"https://kingofspades.github.io/posts/controlling-pod-rollout-and-scaling/"},"url":"https://kingofspades.github.io/posts/controlling-pod-rollout-and-scaling/"}</script><title>Scaling applications - Rollout, Scale and Auto-Scale Deployments | Christian's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Christian's Blog"><meta name="application-name" content="Christian's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.updateMermaid(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/bio-photo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Christian's Blog</a></div><div class="site-subtitle">Stories of /dev/null</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/ex280/" class="nav-link"> <i class="fa-fw fas fa-graduation-cap ml-xl-3 mr-xl-3 unloaded"></i> <span>EX280</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/KingOfSpades" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Scaling applications - Rollout, Scale and Auto-Scale Deployments</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Scaling applications - Rollout, Scale and Auto-Scale Deployments</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/KingOfSpades">Christian A. Benstein</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-01-23 00:00:00 +0100" data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 23, 2022, 12:00 AM +0100" >Jan 23</em> </span> <span> Updated <em class="timeago" date="2022-01-23 22:16:58 +0100 " data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 23, 2022, 10:16 PM +0100" >Jan 23</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1518 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p>This post is gonna be a bit bigger broader then what is requested on the <a href="https://www.redhat.com/en/services/training/ex280-red-hat-certified-specialist-in-openshift-administration-exam?section=Objectives">EX280 exam objectives</a>. In this post we will have a look at:</p><ul><li>Controlling roll-out of pods (manually rolling out or back a deployment)<li>Scaling Deployments on the command-line<li>Creating a auto scaler for a deployment on the command-line</ul><p>Now, apart from the scaling being an exam objective it’s really handy to know how to scale pods and how to control the rollout of deployments. This is certainly something I use almost on a daily basis when operating a container cluster. So, let’s go!</p><h1 id="what-even-is-a-deployment">What even is a “Deployment”</h1><p>When we use <code class="language-plaintext highlighter-rouge">oc new-app</code> we are creating a <code class="language-plaintext highlighter-rouge">Deployment</code> that sets up a <code class="language-plaintext highlighter-rouge">ReplicaSet</code> which in turn starts te pods.</p><pre><code class="language-mermaid">graph LR
    Deployment --&gt; |Manages| ReplicaSet--&gt; |Manages| Pods
</code></pre><p>Let’s have a look at the options.</p><h2 id="deployment-or-deploymentconfig">Deployment or DeploymentConfig<a href="#deployment-or-deploymentconfig"><i class="fas fa-hashtag"></i></a></h2></h2><p>So, I found this really confusing. In Openshift there are resource to control your deployment (the app that you want to run). In short, this is how it is:</p><ul><li><strong>Deployment</strong> is an API resource that controls ScaleSets and Pods. The <code class="language-plaintext highlighter-rouge">deployment</code> resource is kubernetes native and is the default that is being used when using <code class="language-plaintext highlighter-rouge">oc new-app</code> <sup id="fnref:DeploymentConfigsOpenshift" role="doc-noteref"><a href="#fn:DeploymentConfigsOpenshift" class="footnote" rel="footnote">1</a></sup><li><strong>DeplymentConfig</strong> is almost the same as a <code class="language-plaintext highlighter-rouge">deployment</code>. It used to be included in Kubernetes but has been removed from the API. In Openshift we can still use the resource when we use the <code class="language-plaintext highlighter-rouge">oc new-app</code> command with the flag <code class="language-plaintext highlighter-rouge">--as-deployment-config</code> <sup id="fnref:DeploymentConfigsOpenshift:1" role="doc-noteref"><a href="#fn:DeploymentConfigsOpenshift" class="footnote" rel="footnote">1</a></sup></ul><p>To create a DeploymentConfig from the command line use:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc new-app <span class="nt">--as-deployment-config</span> ... 
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Deployment</code> and <code class="language-plaintext highlighter-rouge">DeploymentConfigs</code> are API object in your cluster that manage the pods that are running. They do this (most of the time) by using ScaleSets. When u update a Deployment (with a ConfigMap for example) the Deployment will trigger a new rollout of the pod(s).</p><h2 id="viewing-deployments-and-deploymentconfigs">Viewing Deployments and DeploymentConfigs<a href="#viewing-deployments-and-deploymentconfigs"><i class="fas fa-hashtag"></i></a></h2></h2><p>We can view <code class="language-plaintext highlighter-rouge">Deployments</code> and <code class="language-plaintext highlighter-rouge">DeploymentConfigs</code> with the basic <code class="language-plaintext highlighter-rouge">oc get RESOURCE_TYPE</code> command. To get some data we will setup a namespace and deploy two app’s to it. We will create the app <code class="language-plaintext highlighter-rouge">deployment-app</code> as an example of a <code class="language-plaintext highlighter-rouge">Deployment</code> and a second app called <code class="language-plaintext highlighter-rouge">deploymentconfig-app</code> as an example of a <code class="language-plaintext highlighter-rouge">DeploymentConfig</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc new-project deploying-can-be-fun
<span class="nv">$ </span>oc new-app <span class="nt">--name</span> deployment-app <span class="nt">--image</span> bitnami/nginx
<span class="nv">$ </span>oc new-app <span class="nt">--as-deployment-config</span> <span class="nt">--name</span> deploymentconfig-app <span class="nt">--image</span> bitnami/nginx
</pre></table></code></div></div><p>Now lets <code class="language-plaintext highlighter-rouge">get</code> them:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc get deployment
NAME             READY   UP-TO-DATE   AVAILABLE   AGE
deployment-app   1/1     1            1           51
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc get deploymentconfig
AME                   REVISION   DESIRED   CURRENT   TRIGGERED BY
deploymentconfig-app   1          1         1         config,image<span class="o">(</span>deploymentconfig-app:latest<span class="o">)</span>
</pre></table></code></div></div><p>Straight away we can see a difference between the two. The “Triggered by” field is shown on the the <code class="language-plaintext highlighter-rouge">DeploymentConfig</code>. As we can see the app will be rolled out when the <code class="language-plaintext highlighter-rouge">config</code> changes and it’s currently on the <code class="language-plaintext highlighter-rouge">latest</code> status</p><h2 id="rolling-out-a-new-deployment">Rolling out a new Deployment<a href="#rolling-out-a-new-deployment"><i class="fas fa-hashtag"></i></a></h2></h2><p>What if you want to rollout a new version of your app? Just for fun without changing it. We can do that</p><h3 id="deploymentconfig-style">DeploymentConfig style<a href="#deploymentconfig-style"><i class="fas fa-hashtag"></i></a></h3></h3><p>Running a new deployment with a <code class="language-plaintext highlighter-rouge">DeploymentConfig</code> is really easy, use <sup id="fnref:DeploymentOpenshift" role="doc-noteref"><a href="#fn:DeploymentOpenshift" class="footnote" rel="footnote">2</a></sup> :</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc rollout latest deploymentconfig/deploymentconfig-app
deploymentconfig.apps.openshift.io/deploymentconfig-app rolled out
</pre></table></code></div></div><p>And your done. To verify your work you can use <code class="language-plaintext highlighter-rouge">oc rollout history</code> to see that the cluster has rolled out a new version:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc rollout <span class="nb">history </span>deploymentconfig/deploymentconfig-app
deploymentconfig.apps.openshift.io/deploymentconfig-app
REVISION	STATUS		CAUSE
1		Complete	config change
2		Complete	manual change 
</pre></table></code></div></div><h3 id="deployment-style">Deployment style<a href="#deployment-style"><i class="fas fa-hashtag"></i></a></h3></h3><p>To trigger a new rollout of a <code class="language-plaintext highlighter-rouge">Deployment</code> we are going to change something in the <code class="language-plaintext highlighter-rouge">Deployment</code>. We will trigger a new rollout by updating the “last restart” of the container using <code class="language-plaintext highlighter-rouge">oc patch</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc patch deployment/deployment-app <span class="nt">--patch</span> <span class="se">\</span>
<span class="s2">"{</span><span class="se">\"</span><span class="s2">spec</span><span class="se">\"</span><span class="s2">:{</span><span class="se">\"</span><span class="s2">template</span><span class="se">\"</span><span class="s2">:{</span><span class="se">\"</span><span class="s2">metadata</span><span class="se">\"</span><span class="s2">:{</span><span class="se">\"</span><span class="s2">annotations</span><span class="se">\"</span><span class="s2">:{</span><span class="se">\"</span><span class="s2">last-restart</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="sb">`</span><span class="nb">date</span> +<span class="s1">'%s'</span><span class="sb">`</span><span class="se">\"</span><span class="s2">}}}}}"</span>
deployment.apps/deployment-app patched
</pre></table></code></div></div><h2 id="rolling-back">Rolling back<a href="#rolling-back"><i class="fas fa-hashtag"></i></a></h2></h2><p>A great feature of rollouts is that a history of your rollouts is kept. This makes it easy to recover from configuration mistakes or to abort and rollback the release of a new rollout.</p><p>To rollback a rollout you can use <code class="language-plaintext highlighter-rouge">oc rollout undo</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc rollout undo deploymentconfig deploymentconfig-app
deploymentconfig.apps.openshift.io/deploymentconfig-app rolled back 
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc rollout undo deployment deployment-app
deployment.apps/deployment-app rolled back 
</pre></table></code></div></div><h3 id="deployment-history">Deployment history<a href="#deployment-history"><i class="fas fa-hashtag"></i></a></h3></h3><p>As seen in a previous example we can see the history of rollouts. This also gives us the ability to rollback to a specific version, simply use the <code class="language-plaintext highlighter-rouge">--to-revision</code> flag:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc rollout <span class="nb">history </span>deploymentconfig/deploymentconfig-app
deploymentconfig.apps.openshift.io/deploymentconfig-app
REVISION	STATUS		CAUSE
1		Complete	config change
2		Complete	manual change
3		Complete	manual change
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc rollout undo <span class="nt">--to-revision</span> 1 deploymentconfig/deploymentconfig-app
deploymentconfig.apps.openshift.io/deploymentconfig-app rolled back
</pre></table></code></div></div><h2 id="further-options">Further options<a href="#further-options"><i class="fas fa-hashtag"></i></a></h2></h2><p>There are allot of other options you can use with <code class="language-plaintext highlighter-rouge">oc rollout</code>. Have a look at the help prompt:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="s">$ oc rollout -h</span>
<span class="s">Start a new rollout, view its status or history, rollback to a previous revision of your app.</span>

<span class="s">....</span>

<span class="na">Usage</span><span class="pi">:</span>
  <span class="s">oc rollout SUBCOMMAND [flags]</span>

<span class="na">Available Commands</span><span class="pi">:</span>
  <span class="s">cancel      Cancel the in-progress deployment</span>
  <span class="s">history     View rollout history</span>
  <span class="s">latest      Start a new rollout for a deployment config with the latest state from its triggers</span>
  <span class="s">pause       Mark the provided resource as paused</span>
  <span class="s">restart     Restart a resource</span>
  <span class="s">resume      Resume a paused resource</span>
  <span class="s">retry       Retry the latest failed rollout</span>
  <span class="s">status      Show the status of the rollout</span>
  <span class="s">undo        Undo a previous rollout</span> 
</pre></table></code></div></div><h1 id="scaling-it-up">Scaling it up</h1><p>One thing that you hear allot when talking about container platforms is the ability to “scale up” applications. This is done by increasing the number of pods that run you application. Scaling can be done manually or automatically by your cluster. Let’s have a look.</p><h2 id="scaling-from-the-command-line">Scaling from the command line<a href="#scaling-from-the-command-line"><i class="fas fa-hashtag"></i></a></h2></h2><p>We will use a demo app called <code class="language-plaintext highlighter-rouge">scale-me</code> for this demo in the namespace <code class="language-plaintext highlighter-rouge">the-sky-is-the-limit</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc new-project the-sky-is-the-limit
<span class="nv">$ </span>oc new-app <span class="nt">--name</span> scale-me <span class="nt">--image</span> bitnami/nginx
</pre></table></code></div></div><p>When we take a look at the running pods we will see that our <code class="language-plaintext highlighter-rouge">new-app</code> command created a single pod:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc get pods
NAME                        READY   STATUS    RESTARTS   AGE
scale-me-85b69877f9-xxvbp   1/1     Running   0          92s
</pre></table></code></div></div><p>Let’s scale it up using the <code class="language-plaintext highlighter-rouge">oc scale</code> command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc scale deployment/scale-me <span class="nt">--replicas</span> 10
deployment.apps/scale-me scaled
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc get pods
NAME                        READY   STATUS    RESTARTS   AGE
scale-me-85b69877f9-czjvm   1/1     Running   0          13s
scale-me-85b69877f9-jdcwp   1/1     Running   0          13s
scale-me-85b69877f9-k6v45   1/1     Running   0          13s
scale-me-85b69877f9-k75c4   1/1     Running   0          13s
scale-me-85b69877f9-ldsv4   1/1     Running   0          13s
scale-me-85b69877f9-p2pq2   1/1     Running   0          13s
scale-me-85b69877f9-pspnn   1/1     Running   0          13s
scale-me-85b69877f9-sl78f   1/1     Running   0          13s
scale-me-85b69877f9-t62b8   1/1     Running   0          13s
scale-me-85b69877f9-xxvbp   1/1     Running   0          2m24s
</pre></table></code></div></div><p>And well, that’s it. It’s that easy.</p><h1 id="scaling-on-auto">Scaling on auto</h1><p>As I wrote before. Scaling can also be done automatically. Normally this is done by letting the cluster keep an eye on the CPU usage of the pods <sup id="fnref:OpenshiftAutoScaling" role="doc-noteref"><a href="#fn:OpenshiftAutoScaling" class="footnote" rel="footnote">3</a></sup>. We do this by creating a <code class="language-plaintext highlighter-rouge">autoscaler</code>. An autoscaler can automatically increase or decrease number of pods deployed within the deployment as needed.</p><div class="alert alert-info" role="alert"><i class="fa fa-exclamation-circle"></i> <b>Info:</b> The <code class="language-plaintext highlighter-rouge">autoscaler</code> uses the Openshift metric server to check the CPU usage of a pod. If you do not have a running metric server (like when using CRC) you can create autoscalers but they wont do anything</div><h2 id="creating-a-auto-scaler">Creating a auto-scaler<a href="#creating-a-auto-scaler"><i class="fas fa-hashtag"></i></a></h2></h2><p>To create the autoscale we will use <code class="language-plaintext highlighter-rouge">oc autoscaler</code>. We will set it to scale to minimum of 5 pods and a max of 10. We will use 60% as the target CPU usage:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc autoscale deployment/scale-me <span class="se">\</span>
  <span class="nt">--min</span> 5 <span class="se">\</span>
  <span class="nt">--max</span> 10 <span class="se">\</span>
  <span class="nt">--cpu-percent</span> 60
horizontalpodautoscaler.autoscaling/scale-me autoscaled
</pre></table></code></div></div><p>And thats it… Ow wait! There is more. If you been following along with this last example and you do a <code class="language-plaintext highlighter-rouge">oc get pods</code> you might notice something strange:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc get pods
NAME                        READY   STATUS    RESTARTS   AGE
scale-me-85b69877f9-czjvm   1/1     Running   0          10m
scale-me-85b69877f9-jdcwp   1/1     Running   0          10m
scale-me-85b69877f9-k6v45   1/1     Running   0          10m
scale-me-85b69877f9-k75c4   1/1     Running   0          10m
scale-me-85b69877f9-ldsv4   1/1     Running   0          10m
scale-me-85b69877f9-p2pq2   1/1     Running   0          10m
scale-me-85b69877f9-pspnn   1/1     Running   0          10m
scale-me-85b69877f9-sl78f   1/1     Running   0          10m
scale-me-85b69877f9-t62b8   1/1     Running   0          10m
scale-me-85b69877f9-xxvbp   1/1     Running   0          12m 
</pre></table></code></div></div><p>That’s strange? We set the <code class="language-plaintext highlighter-rouge">--min</code> to 5 pods right?</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc get horizontalpodautoscaler.autoscaling/scale-me
NAME       REFERENCE             TARGETS         MINPODS   MAXPODS   REPLICAS   AGE
scale-me   Deployment/scale-me   &lt;unknown&gt;/60%   5         10        10         7m38 
</pre></table></code></div></div><p>So why are there still 10 pods running? This is because the <code class="language-plaintext highlighter-rouge">autoscale</code> resource uses the requested CPU of a pod to scale. When we take a look at our <code class="language-plaintext highlighter-rouge">Deployment</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc get deployment/scale-me <span class="nt">-o</span> yaml | <span class="nb">grep </span>request
</pre></table></code></div></div><p>We will see that our <code class="language-plaintext highlighter-rouge">deployment</code> has no requested CPU. I haven’t talked about about requests yet but here is a simple way to set one:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>oc <span class="nb">set </span>resources deployment/scale-me <span class="nt">--requests</span> <span class="nv">cpu</span><span class="o">=</span>200m
deployment.apps/scale-me resource requirements updated 
</pre></table></code></div></div><p>After this our pod’s should be rolled out once again (because of a config change) and the cluster should scale them down to 5.</p><h1 id="wrapping-up">Wrapping up</h1><p>I hope you found this useful. I really struggled with the difference between <code class="language-plaintext highlighter-rouge">Deployment</code> and <code class="language-plaintext highlighter-rouge">DeploymentConfig</code> at the start. Let’s hope this has helped you.</p><p>Do you want to see more of my EX280 post’s? Checkout my <a href="https://blog.benstein.nl/ex280/">EX280 page</a></p><div class="footnotes" role="doc-endnotes"><ol><li id="fn:DeploymentConfigsOpenshift" role="doc-endnote"><p>https://docs.openshift.com/container-platform/4.9/applications/deployments/what-deployments-are.html <a href="#fnref:DeploymentConfigsOpenshift" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:DeploymentConfigsOpenshift:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a></p><li id="fn:DeploymentOpenshift" role="doc-endnote"><p>https://docs.openshift.com/container-platform/4.9/applications/deployments/managing-deployment-processes.html <a href="#fnref:DeploymentOpenshift" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:OpenshiftAutoScaling" role="doc-endnote"><p>https://docs.openshift.com/container-platform/4.9/nodes/pods/nodes-pods-autoscaling.html <a href="#fnref:OpenshiftAutoScaling" class="reversefootnote" role="doc-backlink">&#8617;</a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ex280/'>EX280</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/openshift/" class="post-tag no-text-decoration" >openshift</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a> <a href="/tags/ex280/" class="post-tag no-text-decoration" >ex280</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Scaling applications - Rollout, Scale and Auto-Scale Deployments - Christian's Blog&url=https://kingofspades.github.io/posts/controlling-pod-rollout-and-scaling/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Scaling applications - Rollout, Scale and Auto-Scale Deployments - Christian's Blog&u=https://kingofspades.github.io/posts/controlling-pod-rollout-and-scaling/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Scaling applications - Rollout, Scale and Auto-Scale Deployments - Christian's Blog&url=https://kingofspades.github.io/posts/controlling-pod-rollout-and-scaling/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://kingofspades.github.io/posts/controlling-pod-rollout-and-scaling/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/hey-for-loadtesting-http/">hey for load testing http applications</a><li><a href="/posts/building-the-montsinger-rebound-s/">Build-log: Montsinger Rebound-S</a><li><a href="/posts/lets-get-fuzzy/">Let's get fuzzys</a><li><a href="/posts/creating-a-ex280-page/">Creating my EX280 page on Jekyll</a><li><a href="/posts/troubelshooting-permissions-on-pods/">ServiceAccounts and SCCs - Running pods with more permission's</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ex280/">ex280</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/openshift/">openshift</a> <a class="post-tag" href="/tags/macos/">macos</a> <a class="post-tag" href="/tags/cli/">cli</a> <a class="post-tag" href="/tags/customization/">customization</a> <a class="post-tag" href="/tags/alfred/">alfred</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/azure/">azure</a> <a class="post-tag" href="/tags/devops/">devops</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/quotas-limits-and-limit-ranges/"><div class="card-body"> <em class="timeago small" date="2022-01-29 00:00:00 +0100" >Jan 29</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Quotas, limits and limit-ranges</h3><div class="text-muted small"><p> In this post we will be diving in to quotas and limits. Quotas and limits can be used to allocate, limit en reserve resources within your cluster for one or multiple namepaces and can limit the usa...</p></div></div></a></div><div class="card"> <a href="/posts/pod-affinity-and-anti-affinity/"><div class="card-body"> <em class="timeago small" date="2022-02-06 00:00:00 +0100" >Feb 6</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pod Affinity and Anti-affinity - Spreading out workloads</h3><div class="text-muted small"><p> I have written about using Taints and Tolerations to prevent pods from running on certain (tainted) nodes and there is some influence on scheduling that we can exert using Limits and Requests. But...</p></div></div></a></div><div class="card"> <a href="/posts/setting-up-auth-and-users/"><div class="card-body"> <em class="timeago small" date="2022-02-20 00:00:00 +0100" >Feb 20</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Manage users and policies, groups and permissions</h3><div class="text-muted small"><p> This blog will cover the “Manage users and policies” objective of the EX280 exam from RedHat. In this post we will: Configure the HTPasswd identity provider for authentication Create and dele...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/troubelshooting-permissions-on-pods/" class="btn btn-outline-primary" prompt="Older"><p>ServiceAccounts and SCCs - Running pods with more permission's</p></a> <a href="/posts/quotas-limits-and-limit-ranges/" class="btn btn-outline-primary" prompt="Newer"><p>Quotas, limits and limit-ranges</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://kingofspades.github.io/posts/controlling-pod-rollout-and-scaling/'; this.page.identifier = '/posts/controlling-pod-rollout-and-scaling/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://https-blog-benstein-nl.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/KingOfSpades">Christian A. Benstein</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ex280/">ex280</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/openshift/">openshift</a> <a class="post-tag" href="/tags/macos/">macos</a> <a class="post-tag" href="/tags/cli/">cli</a> <a class="post-tag" href="/tags/customization/">customization</a> <a class="post-tag" href="/tags/alfred/">alfred</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/azure/">azure</a> <a class="post-tag" href="/tags/devops/">devops</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-9VZBEPDENQ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-9VZBEPDENQ'); }); </script>
